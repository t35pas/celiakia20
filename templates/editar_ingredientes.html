{% extends 'layout.html' %}

{% block content %}

<section class="py-3 p-t-14">
    <div class="container">
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-primary alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        <div class="row">
            <div class="col-lg-9">
                <h1 class="font-weight-bold color-black">Recetas</h1>
                <p class="lead text-muted">
                    Nueva Receta - Ingredientes
                </p>
            </div>
            <div class="col-lg-3 d-flex p-t-30">
                <button class="btn-green w-100 align-self-center m-r-4" onclick="history.back()">Anterior</button>
                <a class="btn-green w-100 align-self-center" href="{{ url_for('PrepPorReceta') }}">Siguiente</a>
            </div>
        </div>
        <hr>
    </div>
</section>

<section>
    <div class="container">
        <nav>
            <div class="nav nav-tabs" id="nav-tab" role="tablist">
                <a class="nav-link disabled" id="nav-lista-tab" data-toggle="tab" href="#listaIngredientes" role="tab" aria-controls="nav-lista">Listado de ingredientes totales</a>
                <a class="nav-link disabled" id="nav-agregar-tab" data-toggle="tab" href="#agregarIngrediente" role="tab" aria-controls="nav-agregar">Agregar Ingredientes</a>
                <a class="nav-link active" id="nav-agregar-tab" data-toggle="tab" href="#editarIngrediente" role="tab" aria-controls="nav-editar">{{ nombreIngrediente }}</a>
            </div>
        </nav>
    </div>
</section>

<section>
    <div class="tab-content">
        <div class="tab-content" id="nav-tabContent">
            <div class="tab-pane fade" id="listaIngredientes" role="tabpanel" aria-labelledby="nav-lista-tab">
            </div>

            <div class="tab-pane fade" id="agregarIngrediente" role="tabpanel" aria-labelledby="nav-agregar-tab">
            </div>

            <div class="tab-pane fade show active m-l-400 m-r-500" id="editarIngrediente" role="tabpanel" aria-labelledby="nav-editar-tab">
                <div class="container m-t-15">
                    <div class="row">
                        <div class="col-md-5">
                            <div class="card">
                                <div class="card-body m-b-50">
                                    <span class="form-title">Editar Ingrediente</span>   
                                    <div  class="wrap-input">
                                        <form class="login100-form" id="formEditarIngredientes" method="POST" action="{{ url_for('EditarIngPorReceta', idIxR=idIxR) }}" enctype="multipart/form-data">
                                            {{ formE.hidden_tag() }}    
                                            <div class="col-md-14">
                                                {{ formE.nombreIngrediente.label(class="txt5 text-center col-md-12") }}
                                                <div  class="wrap-input100 m-b-16">
                                                    {% if formE.nombreIngrediente.errors %}
                                                        {{ formE.nombreIngrediente(class="input100 is-invalid") }}
                                                        <div class="invalid-feedback">
                                                            {% for error in formE.nombreIngrediente.errors %}
                                                                    <span>{{ error }}</span> 
                                                            {% endfor %}
                                                        </div>
                                                    {% else %}
                                                        {{ formE.nombreIngrediente(class="input100") }}
                                                        <span class="focus-input100"></span>
                                                    {% endif %}
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    {{ formE.cantidad.label(class="txt5 text-center col-md-12") }}
                                                    <div  class="wrap-input100 validate-input m-b-16">
                                                        {% if formE.cantidad.errors %}                            
                                                            {{ formE.cantidad(class="input100 is-invalid") }}
                                                            <div class="invalid-feedback">
                                                                {% for error in formE.cantidad.errors %}
                                                                    <span>{{ error }}</span> 
                                                                {% endfor %}
                                                            </div>
                                                        {% else %}            
                                                            {{ formE.cantidad(class="input100", type="number") }}
                                                            <span class="focus-input100"></span>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ formE.unidad.label(class="txt5 text-center col-md-12") }}
                                                    <div  class="wrap-input100 validate-input m-b-16">
                                                        {% if formE.unidad.errors %}                            
                                                            {{ formE.unidad(class="input100 is-invalid") }}
                                                            <div class="invalid-feedback">
                                                                {% for error in formE.unidad.errors %}
                                                                    <span>{{ error }}</span> 
                                                                {% endfor %}
                                                            </div>
                                                        {% else %}    
                                                            {{ formE.unidad(class="input100") }}
                                                            <span class="focus-input100"></span>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-14">
                                                {{ formE.nombreImagen.label(class="txt5 text-center col-md-12") }}
                                                <div  class="wrap-input100 validate-input m-b-16">
                                                    {% if formE.nombreImagen.errors %}                            
                                                        {{ formE.nombreImagen(class="input100 is-invalid") }}
                                                        <div class="invalid-feedback">
                                                            {% for error in formE.nombreImagen.errors %}
                                                                <span>{{ error }}</span> 
                                                            {% endfor %}
                                                        </div>
                                                    {% else %}    
                                                        {{ formE.nombreImagen(class="input100") }}
                                                        <span class="focus-input100"></span>
                                                    {% endif %}
                                                </div>
                                            </div>

                                            <div class="col-md-12">
                                                <div  class="wrap-input100 validate-input m-b-16">
                                                    {% if formE.imagenIngrediente.errors %}                        
                                                        {{ formE.imagenIngrediente }}
                                                        <div class="invalid-feedback">
                                                            {% for error in formE.imagenIngrediente.errors %}
                                                                <span>{{ error }}</span> 
                                                            {% endfor %}
                                                        </div>
                                                    {% else %}
                                                        {{ formE.imagenIngrediente }}
                                                    {% endif %}
                                                </div>
                                            </div>

                                            <div class="container-login100-form-btn">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <a href="{{ url_for('IngPorReceta') }}" class="login100-form-btncancell"> Cancelar </a>
                                                    </div>
                                                    <div class="col-md-6">
                                                        {{ formE.submit(class="login100-form-btn") }}
                                                    </div>  
                                                </div>
                                            </div>

                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-7 p-l-0">
                            <div class="card">
                                <div class="card-body">
                                    <div class="dataTable">
                                        <table class="display table table-striped" style="width: 100%;">
                                            <thead class="thead-dark">
                                                <tr>
                                                    <th scope="col">Cantidad</th>
                                                    <th scope="col">Unidad</th>
                                                    <th scope="col">Descripci√≥n</th>
                                                    <th scope="col">Imagen</th>
                                                    <th></th>
                                                </tr>
                                            </thead>
                                            
                                            <tbody>
                                                {% for ixr in ingredientes %}
                                                    <tr>
                                                        <td>{{ ixr.cantidad }}</td>
                                                        <td>{{ ixr.ingredientes.unidad.descripcion }}</td>
                                                        <td>{{ ixr.ingredientes.descripcion }}</td>
                                                        <td>{{ ixr.ingredientes.nombre_imagen }}</td>
                                                        <td>
                                                            <a id="edit{{ixr.id}}" type="button" class="btn btn-outline-info" href="/ingredientes/editar/{{ixr.id}}">
                                                                <i class="bi bi-pencil-square"></i>
                                                            </a>
                                                            <a id="delete{{ixr.id}}" href="/ingredientes/eliminar/{{ixr.id}}" class="btn btn-outline-danger" onclick="return confirm('Estas seguro que deseas eliminar el ingrediente de la receta?')">
                                                                <i class="bi bi-trash"></i>
                                                            </a>
                                                        </td>
                                                    </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}